<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>G√©n√©rateur de Phrases - OutilsProfs</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap');

        :root {
            --bg-page: #121212; --card-bg: #1e1e1e; --text-main: #ffffff;
            --column-border: rgba(255, 255, 255, 0.1); --input-bg: #2a2a2a;
        }

        body.light-mode {
            --bg-page: #eeeeee; --card-bg: #ffffff; --text-main: #111827;
            --column-border: rgba(0, 0, 0, 0.1); --input-bg: #f3f4f6;
        }

        body { font-family: 'Inter', sans-serif; background-color: var(--bg-page); color: var(--text-main); margin: 0; transition: background 0.3s ease; }
        
        header { 
            background: var(--card-bg); border-bottom: 1px solid var(--column-border);
            position: sticky; top: 0; z-index: 100; display: flex; align-items: center;
            justify-content: space-between; padding: calc(env(safe-area-inset-top) + 10px) 15px 10px 15px; 
            width: 100%; margin-bottom: 20px;
        }

        .ui-btn-round { width: 38px; height: 38px; display: flex; align-items: center; justify-content: center; border-radius: 50%; flex-shrink: 0; transition: all 0.2s ease; cursor: pointer; border: none; }
        header h1 { font-size: 1.125rem; font-weight: 900; text-transform: uppercase; text-align: center; flex-grow: 1; }

        .main-wrapper { width: 100%; max-width: 900px; margin: 0 auto; padding: 0 15px 40px; }
        .main-container { display: flex; flex-direction: column; gap: 20px; }
        @media (min-width: 1024px) { .main-container { flex-direction: row; align-items: flex-start; } }

        .preview-area {
            flex: 1; background: white; border-radius: 1.5rem; padding: 30px;
            border: 1px solid var(--column-border); min-height: 400px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .sentence-display {
            display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;
        }

        .word-tag {
            padding: 10px 20px; border-radius: 8px; font-weight: 800; color: white;
            text-transform: uppercase; font-size: 14px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .tag-sujet { background-color: #3b82f6; border: 2px solid #2563eb; } /* Bleu */
        .tag-verbe { background-color: #ef4444; border: 2px solid #dc2626; } /* Rouge */
        .tag-complement { background-color: #10b981; border: 2px solid #059669; } /* Vert */

        .controls { flex: 0 0 320px; background: var(--card-bg); border-radius: 1.5rem; padding: 25px; border: 1px solid var(--column-border); }
        .input-group { margin-bottom: 15px; }
        .input-field { width: 100%; background: var(--input-bg); border: 1px solid var(--column-border); color: inherit; padding: 12px; border-radius: 12px; font-size: 13px; outline: none; margin-top: 5px; }
        .btn-action { width: 100%; padding: 14px; border-radius: 50px; font-weight: 900; font-size: 11px; text-transform: uppercase; border: none; cursor: pointer; margin-top: 10px; }
    </style>
</head>
<body>

<header>
    <a href="generateurs.html" id="btn-retour" class="ui-btn-round">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15 19l-7-7 7-7" /></svg>
    </a>
    <h1>G√©n√©rateur de Phrases</h1>
    <button id="btn-aide" class="ui-btn-round text-lg">üí°</button>
</header>

<div class="main-wrapper">
    <div class="main-container">
        <div class="preview-area">
            <div id="sentence-preview" class="sentence-display">
                </div>
            <p class="text-slate-400 text-[10px] mt-8 uppercase font-bold tracking-widest">Aper√ßu des √©tiquettes</p>
        </div>

        <aside class="controls">
            <div class="input-group">
    <label class="text-[10px] font-black uppercase opacity-50 tracking-widest">Sujets</label>
    <textarea id="in-sujets" class="input-field" rows="3">Le petit chat, La ma√Ætresse, Les enfants, Maman, Le pompier, Le jardinier, Mon ami, Le vent, Le boulanger, L'astronaute</textarea>
</div>

<div class="input-group">
    <label class="text-[10px] font-black uppercase opacity-50 tracking-widest">Verbes</label>
    <textarea id="in-verbes" class="input-field" rows="3">mange, √©crit, jouent, pr√©pare, √©teint, arrose, √©coute, pousse, p√©trit, regarde</textarea>
</div>

<div class="input-group">
    <label class="text-[10px] font-black uppercase opacity-50 tracking-widest">Compl√©ments</label>
    <textarea id="in-complements" class="input-field" rows="3">sa p√¢t√©e, la date, au ballon, une tarte, le feu, les fleurs, la musique, les nuages, le pain, les √©toiles</textarea>
</div>

            <button onclick="updatePreview()" id="btn-refresh" class="btn-action">Actualiser l'aper√ßu</button>
            <button onclick="exportPDF()" id="btn-pdf" class="btn-action">T√©l√©charger les √©tiquettes (PDF)</button>
        </aside>
    </div>
</div>

<script>
    if (localStorage.getItem('theme_mode') === 'light') document.body.classList.add('light-mode');

    const mapCouleurs = { 'red': '#ef4444', 'orange': '#f97316', 'amber': '#f59e0b', 'yellow': '#eab308', 'lime': '#84cc16', 'green': '#22c55e', 'emerald': '#10b981', 'teal': '#14b8a6', 'cyan': '#06b6d4', 'sky': '#0ea5e9', 'blue': '#3b82f6', 'indigo': '#6366f1', 'violet': '#8b5cf6', 'purple': '#a855f7', 'fuchsia': '#d946ef', 'pink': '#ec4899', 'rose': '#f43f5e' };

    function appliquerTheme() {
        const themePrefs = JSON.parse(localStorage.getItem('theme_tuiles')) || {};
        const colPref = themePrefs.gen || 'cyan'; 
        const hexa = mapCouleurs[colPref];
        const isDarkText = ['yellow', 'lime', 'amber', 'cyan'].includes(colPref);
        const contrast = isDarkText ? '#000' : '#fff';

        [document.getElementById('btn-retour'), document.getElementById('btn-aide'), document.getElementById('btn-pdf'), document.getElementById('btn-refresh')].forEach(el => {
            if(el) { el.style.backgroundColor = hexa; el.style.color = contrast; }
        });
    }

    function updatePreview() {
    const preview = document.getElementById('sentence-preview');
    preview.innerHTML = '';

    // On r√©cup√®re les listes et on nettoie les espaces
    const sujets = document.getElementById('in-sujets').value.split(',').map(s => s.trim()).filter(s => s !== "");
    const verbes = document.getElementById('in-verbes').value.split(',').map(v => v.trim()).filter(v => v !== "");
    const complements = document.getElementById('in-complements').value.split(',').map(c => c.trim()).filter(c => c !== "");

    // On affiche les 3 premi√®res combinaisons pour l'aper√ßu
    for (let i = 0; i < Math.min(3, sujets.length); i++) {
        const row = document.createElement('div');
        row.className = "flex gap-2 mb-4 flex-wrap justify-center";
        
        const s = sujets[i] || "";
        const v = verbes[i] || "";
        const c = complements[i] || "";

        if(s) row.innerHTML += `<div class="word-tag tag-sujet">${s}</div>`;
        if(v) row.innerHTML += `<div class="word-tag tag-verbe">${v}</div>`;
        if(c) row.innerHTML += `<div class="word-tag tag-complement">${c}</div>`;
        
        preview.appendChild(row);
    }

    if (preview.innerHTML === '') {
        preview.innerHTML = '<p class="text-slate-400 text-xs italic">Entrez des mots s√©par√©s par des virgules pour voir l\'aper√ßu</p>';
    }
}

    function exportPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        const sujets = document.getElementById('in-sujets').value.split(',').map(x => x.trim()).filter(x => x);
        const verbes = document.getElementById('in-verbes').value.split(',').map(x => x.trim()).filter(x => x);
        const complements = document.getElementById('in-complements').value.split(',').map(x => x.trim()).filter(x => x);

        let currentY = 20;

        const drawTags = (list, colorR, colorG, colorB, title) => {
            doc.setFontSize(10);
            doc.setTextColor(100);
            doc.text(title, 15, currentY);
            currentY += 5;

            list.forEach(text => {
                if (currentY > 270) { doc.addPage(); currentY = 20; }
                doc.setDrawColor(colorR, colorG, colorB);
                doc.setFillColor(colorR, colorG, colorB);
                doc.rect(15, currentY, 60, 12, 'FD');
                doc.setTextColor(255);
                doc.setFontSize(12);
                doc.text(text.toUpperCase(), 18, currentY + 8);
                currentY += 15;
            });
            currentY += 10;
        };

        drawTags(sujets, 59, 130, 246, "SUJETS (BLEU)");
        drawTags(verbes, 239, 68, 68, "VERBES (ROUGE)");
        drawTags(complements, 16, 185, 129, "COMPL√âMENTS (VERT)");

        doc.save("etiquettes-grammaire.pdf");
    }

    window.onload = () => {
        appliquerTheme();
        updatePreview();
    };
</script>
</body>
</html>